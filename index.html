<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ƒêi t√¨m kho b√°u</title>

<style>
* { box-sizing: border-box; font-family: system-ui, sans-serif; }
html, body {
  margin: 0;
  height: 100%;
}

body {
  background: url("assets/images/sea-bg.jpg") center/cover no-repeat fixed;
  display: flex;
  justify-content: center;
  align-items: center;
}

.game-box {
  background: rgba(0,0,0,0.65);
  color: #fff;
  padding: 20px;
  border-radius: 14px;
  width: 95%;
  max-width: 500px;
  text-align: center;
}

button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  cursor: pointer;
}

.start-btn { background: #f4c430; color: #000; }
.answer-btn { background: #1e90ff; color: #fff; }
.answer-btn:hover { opacity: 0.85; }

.hidden { display: none; }

.progress {
  margin-bottom: 10px;
  font-size: 14px;
  opacity: 0.85;
}
</style>
</head>

<body>

<div class="game-box">
  <div class="progress" id="progress"></div>

  <h2 id="question">ƒêi t√¨m kho b√°u üè¥‚Äç‚ò†Ô∏è</h2>

  <div id="answers"></div>

  <button class="start-btn" id="startBtn">M·ªü √¥ kho b√°u</button>
</div>

<!-- AUDIO -->
<audio id="bgm" src="assets/sounds/bgm.mp3" loop></audio>
<audio id="correctSound" src="assets/sounds/correct.mp3"></audio>
<audio id="wrongSound" src="assets/sounds/wrong.mp3"></audio>

<script>
let questions = [];
let usedIndexes = [];
let currentQuestion = null;

const qEl = document.getElementById("question");
const answersEl = document.getElementById("answers");
const startBtn = document.getElementById("startBtn");
const progressEl = document.getElementById("progress");

const bgm = document.getElementById("bgm");
const correctSound = document.getElementById("correctSound");
const wrongSound = document.getElementById("wrongSound");

fetch("questions.json")
  .then(res => res.json())
  .then(data => questions = data);

function getRandomQuestion() {
  if (usedIndexes.length === questions.length) {
    qEl.innerText = "üéâ B·∫°n ƒë√£ t√¨m th·∫•y kho b√°u!";
    answersEl.innerHTML = "";
    startBtn.classList.remove("hidden");
    startBtn.innerText = "Ch∆°i l·∫°i";
    return null;
  }

  let index;
  do {
    index = Math.floor(Math.random() * questions.length);
  } while (usedIndexes.includes(index));

  usedIndexes.push(index);
  return questions[index];
}

function showQuestion() {
  currentQuestion = getRandomQuestion();
  if (!currentQuestion) return;

  progressEl.innerText = `Kho b√°u ƒë√£ m·ªü: ${usedIndexes.length}/${questions.length}`;
  qEl.innerText = currentQuestion.question;
  answersEl.innerHTML = "";

  currentQuestion.options.forEach(opt => {
    const btn = document.createElement("button");
    btn.className = "answer-btn";
    btn.innerText = opt;
    btn.onclick = () => checkAnswer(opt);
    answersEl.appendChild(btn);
  });
}

function checkAnswer(answer) {
  if (answer === currentQuestion.answer) {
    correctSound.play();
    setTimeout(showQuestion, 600);
  } else {
    wrongSound.play();
    setTimeout(resetGame, 800);
  }
}

function resetGame() {
  usedIndexes = [];
  qEl.innerText = "‚ùå Sai r·ªìi! Quay l·∫°i t·ª´ ƒë·∫ßu";
  answersEl.innerHTML = "";
  progressEl.innerText = "";
  startBtn.classList.remove("hidden");
  startBtn.innerText = "Ch∆°i l·∫°i";
}

startBtn.onclick = () => {
  startBtn.classList.add("hidden");
  bgm.play();
  showQuestion();
};
</script>

</body>
</html>
